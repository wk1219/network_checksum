#include<stdio.h>
#include<string.h>
#include<vector>
#include<unistd.h>
#include<stdint.h>
#include<arpa/inet.h>
using namespace std;
int main(){
// UDP Data area
//unsigned char data[44] = {0x53,0x70,0x6f,0x74,0x55,0x64,0x70,0x30,0x06,0xe3,0xb1,0xd5,0x0f,0x3c,0x93,0x31,0x00,0x01,0x00,0x04,0x48,0x95,0xc2,0x03,0x3a,0x26,0xa3,0x4d,0x71,0xc7,0x45,0xf8,0x82,0xbd,0x84,0x49,0x18,0x90,0xc6,0xb8,0xd0,0xef,0x7a,0x5d};


// UDP checksum = UDP Psuedo header + UDP Header + Data
// UDP Psuedo header = SrcIP + DstIP + Zero + Protocol + UDP_length + Src_port + Dst_port + UDP_length + checksum (0x0000)
unsigned char buf[64] = {0xc0,0xa8,0x03,0x96,0xc0,0xa8,0x03,0xff,0x00,0x11,0x00,0x34,0xe1,0x15,0xe1,0x15,0x00, 0x34, 0x00, 0x00,0x53,0x70,0x6f,0x74,0x55,0x64,0x70,0x30,0x06,0xe3,0xb1,0xd5,0x0f,0x3c,0x93,0x31,0x00,0x01,0x00,0x04,0x48,0x95,0xc2,0x03,0x3a,0x26,0xa3,0x4d,0x71,0xc7,0x45,0xf8,0x82,0xbd,0x84,0x49,0x18,0x90,0xc6,0xb8,0xd0,0xef,0x7a,0x5d};
 	int sum=0;
	uint16_t chksum = 0;
	uint16_t buf2[32];

	memcpy(&buf2[0], &buf, 64);
	//ff65
	for(int i=0;i<32;i++)
	{
		sum += static_cast<int>(buf2[i]);
	//printf("%x ", static_cast<int>(ntohs(buf2[i])));	
	}
	chksum = (sum>>16) + (sum & 0xffff);
    	chksum = (chksum^0xffff);
	
	printf("%x\n", ntohs(chksum));
	return 0;
}
